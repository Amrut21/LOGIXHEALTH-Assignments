--
CREATE TABLE ORDERS (id int,
name varchar(22)
, type varchar(22),price int)

INSERT INTO ORDERS VALUES (1,'TV','4K',200000)
INSERT INTO ORDERS VALUES (2,'MOBILE','ANDRIOD',40000)
INSERT INTO ORDERS VALUES (3,'SPEAKER','4:1',10000)
INSERT INTO ORDERS VALUES (4,'BULB','T-BLUB',200)

SELECT * FROM ORDERS

--1 USING MIN
BEGIN TRAN

DELETE FROM ORDERS WHERE ID NOT IN(
SELECT MIN(ID) AS 'MIN' FROM ORDERS
GROUP BY NAME,TYPE)


ROLLBACK

--2 USING SELF JOIN
BEGIN TRAN
DELETE FROM ORDERS WHERE ID IN(
SELECT A.ID FROM ORDERS A,ORDERS B
WHERE A.namE=B.NAME AND A.TYPE=B.type
AND A.ID > B.ID )

ROLLBACK

--3 USING MAX
BEGIN TRAN 
DELETE FROM ORDERS
WHERE ID IN (SELECT MAX(ID) FROM ORDERS
GROUP BY NAME,TYPE
HAVING COUNT(*)>1)

ROLLBACK

--4 USING ROW_NUMBER
ALTER TABLE ORDERS
ADD ROW_NUM INT IDENTITY

DELETE FROM ORDERS WHERE ROW_NUM NOT IN(
SELECT MIN(ROW_NUM) FROM ORDERS
GROUP BY NAME,TYPE)

SELECT * FROM ORDERS

ALTER TABLE ORDERS 
DROP COLUMN ROW_NUM 